version: 2

sources:
  - name: ssa_data
    description: Data from the US Social Security
    tables:
      - name: state_names
        columns:
          - name: state
          - name: sex
          - name: year
          - name: name
          - name: num_births
      - name: territory_names
        columns:
          - name: territory
          - name: sex
          - name: year
          - name: name
          - name: num_births
      - name: yob_national_names_files
        columns:
          - name: sex
          - name: name
          - name: num_births
          - name: file_name
            description: The original file name, e.g. yob2022.txt


models:
  - name: stg_ssa_data__state_names
    config:
      materialized: table
    columns:
      - name: state
      - name: sex
      - name: year
      - name: name
      - name: num_births

  - name: stg_ssa_data__territory_names
    config:
      materialized: table 
    columns:
      - name: territory
      - name: sex
      - name: year
      - name: name
      - name: num_births
  
  - name: stg_ssa_data__yob_national_names
    config:
      materialized: table
    columns:
      - name: sex
      - name: name
      - name: num_births
      - name: year
        description: Year extracted from the file name, e.g. yob2022.txt -> 2022